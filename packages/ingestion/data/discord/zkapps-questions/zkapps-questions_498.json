{
  "guild": {
    "id": "484437221055922177",
    "name": "Mina Protocol",
    "iconUrl": "https://cdn.discordapp.com/icons/484437221055922177/60f5907d2f7e3804b704a7153cae7768.png?size=512"
  },
  "channel": {
    "id": "1188735087928414298",
    "type": "GuildPublicThread",
    "categoryId": "1047214314349658172",
    "category": "zkapps-questions",
    "name": "How to transfer custom tokens from a normal account to a smart contract?",
    "topic": null
  },
  "dateRange": {
    "after": null,
    "before": null
  },
  "exportedAt": "2025-04-24T12:38:10.479163+04:00",
  "messages": [
    {
      "id": "1188735087928414298",
      "type": "Default",
      "timestamp": "2023-12-25T10:48:50.592+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Hi everyone. I have deployed a custom token (let call it \"A\") and  another smart contract (let call it \"B\")  on Berkeley. As I know: When a zkApp interacts with a custom token that it did not originally create, the calling zkApp must get authorization from the token owner. What if I want to send tokens from a normal account to a smart contract like the \"B\" smart contract? I saw an example on Mina docs but it is only apply for sending from a ZkApp to normal account.\nhttps://docs.minaprotocol.com/zkapps/o1js/custom-tokens#proof-authorization-1",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [
        {
          "title": "Mina Documentation",
          "url": "https://docs.minaprotocol.com/zkapps/o1js/custom-tokens",
          "timestamp": null,
          "description": "Website for documentation about Mina Protocol",
          "thumbnail": {
            "url": "https://images-ext-1.discordapp.net/external/_PJlmeDNad-_70g7jbEdYnu0Z3mezgosb1bPK642OJE/https/docs.minaprotocol.com/img/common/mina-logo.png",
            "width": 1120,
            "height": 630
          },
          "images": [],
          "fields": []
        }
      ],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1188757193961521203",
      "type": "Reply",
      "timestamp": "2023-12-25T12:16:41.081+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "My last two tests are for transferring custom tokens from a normal account to a smart contract (I've called them vaults) and from a smart contract to a normal account.\n<https://github.com/BerzanOrg/xane/blob/main/contracts/src/Vault.test.ts#L82>\nGenerally `SmartContract.token.send()` method should work whether the destination is a normal account's address or a smart contract's address.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "",
            "name": "\uD83D\uDE80",
            "code": "rocket",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f680.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "639674469132140554",
              "name": "godot3791",
              "discriminator": "0000",
              "nickname": "Martin",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
            }
          ]
        },
        {
          "emoji": {
            "id": "",
            "name": "\uD83D\uDE4F",
            "code": "pray",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "639674469132140554",
              "name": "godot3791",
              "discriminator": "0000",
              "nickname": "Martin",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
            }
          ]
        },
        {
          "emoji": {
            "id": "",
            "name": "\uD83D\uDC4D",
            "code": "thumbsup",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "964566918482784306",
              "name": "dfst.io",
              "discriminator": "0000",
              "nickname": "DFST",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/964566918482784306/d8fb8d3c806d8530658b94a99e9110f9.png?size=512"
            }
          ]
        }
      ],
      "mentions": [
        {
          "id": "639674469132140554",
          "name": "godot3791",
          "discriminator": "0000",
          "nickname": "Martin",
          "color": "#FFFFFF",
          "isBot": false,
          "roles": [
            {
              "id": "1220065449098743838",
              "name": "Node-Operations",
              "color": "#FFFFFF",
              "position": 20
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1188735087928414298",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1188760648507740221",
      "type": "Default",
      "timestamp": "2023-12-25T12:30:24.709+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Thank you @berzan",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "",
            "name": "❤️",
            "code": "heart",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/2764.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "991037531615264808",
              "name": "berzanorg",
              "discriminator": "0000",
              "nickname": "berzan",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
            }
          ]
        }
      ],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ]
    },
    {
      "id": "1189144549914845276",
      "type": "Default",
      "timestamp": "2023-12-26T13:55:53.937+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Hi @berzan. Do you know about this error?\n```\nTop-level account update can not use or pass on token permissions. Make sure that\n    accountUpdate.body.mayUseToken = AccountUpdate.MayUseToken.No;\n```",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ]
    },
    {
      "id": "1189147138836414576",
      "type": "Default",
      "timestamp": "2023-12-26T14:06:11.184+04:00",
      "timestampEdited": "2023-12-26T14:06:49.095+04:00",
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "This is how I called the contract\n     ```\n     const tx = await Mina.transaction(userPubkey, () => {\n            const callback = Experimental.Callback.create(bridgeZkapp, \"decrementBalance\", [AMOUNT_WITHDRAW])\n            bridgeZkapp.unLock(tokenPubkey, userPubkey, AMOUNT_WITHDRAW, callback)\n     })\n     await tx.prove()\n     tx.sign([userPrivkey])\n     await tx.send()\n```",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189147643193081976",
      "type": "Default",
      "timestamp": "2023-12-26T14:08:11.432+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Inside the bridgeZkapp, there's an unlock method\n```\n@method unLock(tokenAddress: PublicKey, receiver: PublicKey, amount: UInt64, callback: Experimental.Callback<any>) {\n        const weth = new Token(tokenAddress)\n        weth.sendTokens(receiver, amount, callback)\n        this.emitEvent('Unlock', new UnLockEvent(tokenAddress, receiver, amount))\n}\n```",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189147879915405312",
      "type": "Default",
      "timestamp": "2023-12-26T14:09:07.871+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "This is the `sendTokens` inside weth contract:\n```\n  @method sendTokens(\n    receiverAddress: PublicKey,\n    amount: UInt64,\n    callback: Experimental.Callback<any>\n  ) {\n    // approves the callback which deductes the amount of tokens from the sender\n    let senderAccountUpdate = this.approve(callback);\n\n    // Create constraints for the sender account update and amount\n    let negativeAmount = Int64.fromObject(\n      senderAccountUpdate.body.balanceChange\n    );\n    negativeAmount.assertEquals(Int64.from(amount).neg());\n    let tokenId = this.token.id;\n\n    // Create receiver accountUpdate\n    let receiverAccountUpdate = Experimental.createChildAccountUpdate(\n      this.self,\n      receiverAddress,\n      tokenId\n    );\n    receiverAccountUpdate.balance.addInPlace(amount);\n    Provable.log(\"Approved!\", receiverAddress.toBase58(), amount.toString())\n  }\n```",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189167013977919538",
      "type": "Reply",
      "timestamp": "2023-12-26T15:25:09.787+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Hmmm",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "639674469132140554",
          "name": "godot3791",
          "discriminator": "0000",
          "nickname": "Martin",
          "color": "#FFFFFF",
          "isBot": false,
          "roles": [
            {
              "id": "1220065449098743838",
              "name": "Node-Operations",
              "color": "#FFFFFF",
              "position": 20
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189144549914845276",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189168844326051840",
      "type": "Default",
      "timestamp": "2023-12-26T15:32:26.176+04:00",
      "timestampEdited": "2023-12-26T15:35:25.782+04:00",
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "You may need to add a method to token contract similar to `approveUpdate` just to make sure zkapp can send tokens.\n```ts\n    @method approveUpdate(zkappUpdate: AccountUpdate) {\n        this.approve(zkappUpdate)\n        const balanceChange = Int64.fromObject(zkappUpdate.body.balanceChange)\n        balanceChange.assertEquals(Int64.from(0))\n    }\n```",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189169276347760732",
      "type": "Default",
      "timestamp": "2023-12-26T15:34:09.178+04:00",
      "timestampEdited": "2023-12-26T15:34:22.619+04:00",
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "```ts\n it('can deploy vaults', async () => {\n        const tx = await Mina.transaction(userPubkey, () => {\n            AccountUpdate.fundNewAccount(userPubkey)\n            vaultZkapp.deploy() //deploy method of my zkapp in this case I've called it vault\n            tokenZkapp.approveUpdate(vaultZkapp.self) // deploy method creates an account update, and we make token contract approve it\n        })\n        await tx.prove()\n        tx.sign([userPrivkey, vaultPrivkey])\n        await tx.send()\n})\n```",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189169888103759902",
      "type": "Default",
      "timestamp": "2023-12-26T15:36:35.032+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "After token contract approved the account update,  `sendTokens` method should work.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189190023082426458",
      "type": "Default",
      "timestamp": "2023-12-26T16:56:35.585+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "> You might also need to set `access` permission of the token contract to `Permissions.proofOrSignature()`.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189218308642308116",
      "type": "Default",
      "timestamp": "2023-12-26T18:48:59.388+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "I’ve set them but still got the error.",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189218905047187527",
      "type": "Default",
      "timestamp": "2023-12-26T18:51:21.582+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "But I’ve fixed it with the callback pass to the sendTokens",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "",
            "name": "\uD83D\uDCAF",
            "code": "100",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f4af.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "991037531615264808",
              "name": "berzanorg",
              "discriminator": "0000",
              "nickname": "berzan",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
            }
          ]
        }
      ],
      "mentions": []
    },
    {
      "id": "1189219231380807720",
      "type": "Default",
      "timestamp": "2023-12-26T18:52:39.386+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Do you know how to emit an event when a normal account transfer custom token into a zkapp account?",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189219553306230934",
      "type": "Reply",
      "timestamp": "2023-12-26T18:53:56.139+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Is this zkapp account supposed to support multiple custom tokens?",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "639674469132140554",
          "name": "godot3791",
          "discriminator": "0000",
          "nickname": "Martin",
          "color": "#FFFFFF",
          "isBot": false,
          "roles": [
            {
              "id": "1220065449098743838",
              "name": "Node-Operations",
              "color": "#FFFFFF",
              "position": 20
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189219231380807720",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189219871096062075",
      "type": "Reply",
      "timestamp": "2023-12-26T18:55:11.906+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Yes. That’s what I am trying to do",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189219553306230934",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189221030254874705",
      "type": "Default",
      "timestamp": "2023-12-26T18:59:48.271+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "In my case, I needed to support any token on my exchange. \nSo I've created a new vault account for each custom token.\nAs you can see vault accounts share the same public key with the exchange account. \nBut I've specified default token IDs for vaults while constructing them.\nI also had to make related token contracts to approve deployment account updates for each vault. \n```ts\n    const btcVaultZkapp = new Vault(exchangePubkey, btcTokenZkapp.token.id)\n    const usdVaultZkapp = new Vault(exchangePubkey, usdTokenZkapp.token.id)\n```\nhttps://github.com/BerzanOrg/xane/blob/main/contracts/src/Exchange.test.ts#L167",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [
        {
          "title": "xane/contracts/src/Exchange.test.ts at main · BerzanOrg/xane",
          "url": "https://github.com/BerzanOrg/xane/blob/main/contracts/src/Exchange.test.ts",
          "timestamp": null,
          "description": "A zero knowledge order book decentralized exchange. - BerzanOrg/xane",
          "color": "#1E2327",
          "thumbnail": {
            "url": "https://images-ext-1.discordapp.net/external/6SuXdP_AP3dniD3IdETf_t70eoZaBfSsxjWuUJhwI2M/https/opengraph.githubassets.com/b159ac2f923a6e2baaa25de69aea82bff1fbf1a4a9d3e97b7eb67cb83c5c42df/BerzanOrg/xane",
            "width": 1200,
            "height": 600
          },
          "images": [],
          "fields": []
        }
      ],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189221281321725993",
      "type": "Default",
      "timestamp": "2023-12-26T19:00:48.13+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Exchange and bridge logics are different but both share the same concepts.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189221614383014021",
      "type": "Reply",
      "timestamp": "2023-12-26T19:02:07.538+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Now I see you asked about events. \nDoes not `this.emitEvent('Unlock', new UnLockEvent(tokenAddress, receiver, amount))` work as expected?",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "639674469132140554",
          "name": "godot3791",
          "discriminator": "0000",
          "nickname": "Martin",
          "color": "#FFFFFF",
          "isBot": false,
          "roles": [
            {
              "id": "1220065449098743838",
              "name": "Node-Operations",
              "color": "#FFFFFF",
              "position": 20
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189219231380807720",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189222535338934374",
      "type": "Reply",
      "timestamp": "2023-12-26T19:05:47.111+04:00",
      "timestampEdited": "2023-12-26T19:10:17.527+04:00",
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "The unlock event works fine when the user withdraw tokens from the smart contract. However, when a normal user deposit tokens into the smart contract, I don’t know how to emit the event in that case",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189221614383014021",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189238327665238056",
      "type": "Default",
      "timestamp": "2023-12-26T20:08:32.295+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "You can create an abstraction over normal token transfers like below. \n```ts\n@method lock(tokenAddress: PublicKey, amount: UInt64) {\n    const weth = new Token(tokenAddress)\n    weth.sendTokenNormally(this.sender, this.address, amount) // this method should just run `this.token.send()` internally\n    this.emitEvent('Lock', new LockEvent(tokenAddress, this.sender, amount))\n}\n```",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189238554686148659",
      "type": "Default",
      "timestamp": "2023-12-26T20:09:26.421+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "as the user will already be signing the transaction, it will work without a callback.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189241541814931527",
      "type": "Reply",
      "timestamp": "2023-12-26T20:21:18.608+04:00",
      "timestampEdited": "2023-12-26T20:22:35.169+04:00",
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "I don't think that will work, because you would need the verification key of token beforehand.\n\nWhat you probably want to do is:\n1. Create tree of account updates for transfer where root is token owner and children are transfers of token\n2. Pass this account update into your zkapp method which emits an event\n\nSo the call tree will look something like this\n\n```\nYour zkapp\n    |\nToken owner zkapp\n   /  \\\n  /    \\  \nsender receiver\n```\n\nThen in your method you can do approve, to add it as child to your account update and also do some constraints about the children.\n```\n@method emit(tokenAccountUpdate: AccountUpdate) {\n    // Force the layout of the tree\n    this.approve(tokenAccountUpdate, AccountUpdate.Layout.StaticChildren(2));\n\n    const [au1, au2] = tokenAccountUpdate.children.accountUpdates;\n    // do some checks...\n```",
      "author": {
        "id": "141272134633783297",
        "name": "faseris",
        "discriminator": "0000",
        "nickname": "Faserisko",
        "color": "#E5DFBB",
        "isBot": false,
        "roles": [
          {
            "id": "1280898028529778789",
            "name": "Community Builder",
            "color": "#E5DFBB",
            "position": 26
          },
          {
            "id": "1285544625037115557",
            "name": "MinaCon",
            "color": "#FAFFD6",
            "position": 25
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/141272134633783297/906de2260ca3617d3a9792834a64e3c8.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "",
            "name": "\uD83D\uDC4D",
            "code": "thumbsup",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg"
          },
          "count": 3,
          "users": [
            {
              "id": "639674469132140554",
              "name": "godot3791",
              "discriminator": "0000",
              "nickname": "Martin",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
            },
            {
              "id": "964566918482784306",
              "name": "dfst.io",
              "discriminator": "0000",
              "nickname": "DFST",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/964566918482784306/d8fb8d3c806d8530658b94a99e9110f9.png?size=512"
            },
            {
              "id": "991037531615264808",
              "name": "berzanorg",
              "discriminator": "0000",
              "nickname": "berzan",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
            }
          ]
        }
      ],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189238327665238056",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189489771345621034",
      "type": "Default",
      "timestamp": "2023-12-27T12:47:41.14+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Hi @berzan @Faserisko  the transfer works fine on local, but when I deploy the contract and call the method. The `tokenId` is mismatched so the transaction failed. Do you know  what is wrong here?",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [
        {
          "id": "1189489771152670800",
          "url": "https://cdn.discordapp.com/attachments/1188735087928414298/1189489771152670800/image.png?ex=680aa36d&is=680951ed&hm=1a3bd7a63cf889c32ece303b391570abe764998c5629387576145b9c40e5deec&",
          "fileName": "image.png",
          "fileSizeBytes": 54186
        }
      ],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        },
        {
          "id": "141272134633783297",
          "name": "faseris",
          "discriminator": "0000",
          "nickname": "Faserisko",
          "color": "#E5DFBB",
          "isBot": false,
          "roles": [
            {
              "id": "1280898028529778789",
              "name": "Community Builder",
              "color": "#E5DFBB",
              "position": 26
            },
            {
              "id": "1285544625037115557",
              "name": "MinaCon",
              "color": "#FAFFD6",
              "position": 25
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/141272134633783297/906de2260ca3617d3a9792834a64e3c8.png?size=512"
        }
      ]
    },
    {
      "id": "1189495925454950492",
      "type": "Reply",
      "timestamp": "2023-12-27T13:12:08.394+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "`SmartContract.token.id` and `SmartContract.tokenId` is different. The first one is the custom token's ID, and the second one is the ID of the token the contract is deployed with like `new Vault(addr, wethTokenId)`.\nAre you sure that you didn't use `SmartContract.tokenId` instead of `SmartContract.token.id` anywhere?",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "639674469132140554",
          "name": "godot3791",
          "discriminator": "0000",
          "nickname": "Martin",
          "color": "#FFFFFF",
          "isBot": false,
          "roles": [
            {
              "id": "1220065449098743838",
              "name": "Node-Operations",
              "color": "#FFFFFF",
              "position": 20
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189489771345621034",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189496065863471146",
      "type": "Reply",
      "timestamp": "2023-12-27T13:12:41.87+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "I have no idea if it works fine on local but not on Berkeley.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": [
        {
          "id": "639674469132140554",
          "name": "godot3791",
          "discriminator": "0000",
          "nickname": "Martin",
          "color": "#FFFFFF",
          "isBot": false,
          "roles": [
            {
              "id": "1220065449098743838",
              "name": "Node-Operations",
              "color": "#FFFFFF",
              "position": 20
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189489771345621034",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189496212966101043",
      "type": "Default",
      "timestamp": "2023-12-27T13:13:16.942+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Can you share the repository?",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189499089067458591",
      "type": "Default",
      "timestamp": "2023-12-27T13:24:42.658+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "@berzan Here is the repo. please take a look. Thank you \uD83D\uDE4F \nhttps://github.com/Sotatek-TuanHoang/bridge",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [
        {
          "title": "GitHub - Sotatek-TuanHoang/bridge",
          "url": "https://github.com/Sotatek-TuanHoang/bridge",
          "timestamp": null,
          "description": "Contribute to Sotatek-TuanHoang/bridge development by creating an account on GitHub.",
          "color": "#1E2327",
          "thumbnail": {
            "url": "https://images-ext-1.discordapp.net/external/ZH2gw-5rxVOm0uiS8S3sqohMsIVburHyiH7u7etIY88/https/opengraph.githubassets.com/0e8e81923b2af91f7ada54bf02a7886ee37ce4f93d2ca3b2f25c07894aae0dd8/Sotatek-TuanHoang/bridge",
            "width": 1200,
            "height": 600
          },
          "images": [],
          "fields": []
        }
      ],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "",
            "name": "\uD83D\uDC4D",
            "code": "thumbsup",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "991037531615264808",
              "name": "berzanorg",
              "discriminator": "0000",
              "nickname": "berzan",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
            }
          ]
        }
      ],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ]
    },
    {
      "id": "1189500418296905779",
      "type": "Reply",
      "timestamp": "2023-12-27T13:29:59.571+04:00",
      "timestampEdited": "2023-12-27T13:32:09.938+04:00",
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "I debug with `Provable.log` inside the `sendTokensFromZkApp` and it returns the same tokenId on local\n```\nProvable.log(`Token Id:`, this.token.id.toString());\nProvable.log(`Balance Change:`, senderAccountUpdate.body.tokenId, senderAccountUpdate.body.balanceChange)\n```",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "",
            "name": "\uD83E\uDD14",
            "code": "thinking",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f914.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "991037531615264808",
              "name": "berzanorg",
              "discriminator": "0000",
              "nickname": "berzan",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
            }
          ]
        }
      ],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ],
      "reference": {
        "messageId": "1189495925454950492",
        "channelId": "1188735087928414298",
        "guildId": "484437221055922177"
      }
    },
    {
      "id": "1189507530955698299",
      "type": "Default",
      "timestamp": "2023-12-27T13:58:15.361+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Can you make sure you call `bridgeZkapp.deploy()` and make the token contract approve its account update in the same transaction?\nI mean instead of deploying inside this file (<https://github.com/Sotatek-TuanHoang/bridge/blob/main/src/004_deploy_bridge.ts>) in a seperate transaction, you can move bridge deployment inside the transaction inside this file (<https://github.com/Sotatek-TuanHoang/bridge/blob/main/src/005_approve_erc20.ts#L107>)",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "823907640357683282",
            "name": "Mina_Mainnet_Toast",
            "code": "Mina_Mainnet_Toast",
            "isAnimated": false,
            "imageUrl": "https://cdn.discordapp.com/emojis/823907640357683282.png"
          },
          "count": 1,
          "users": [
            {
              "id": "639674469132140554",
              "name": "godot3791",
              "discriminator": "0000",
              "nickname": "Martin",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
            }
          ]
        }
      ],
      "mentions": []
    },
    {
      "id": "1189507778671280168",
      "type": "Default",
      "timestamp": "2023-12-27T13:59:14.421+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "I hope I didn't look at unrelated files.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189507822673739806",
      "type": "Default",
      "timestamp": "2023-12-27T13:59:24.912+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "The smart contracts seem valid.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    },
    {
      "id": "1189524636002693190",
      "type": "Default",
      "timestamp": "2023-12-27T15:06:13.522+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "Combining them into one transaction works for me. Thank you very much @berzan  \uD83D\uDE4F",
      "author": {
        "id": "639674469132140554",
        "name": "godot3791",
        "discriminator": "0000",
        "nickname": "Martin",
        "color": "#FFFFFF",
        "isBot": false,
        "roles": [
          {
            "id": "1220065449098743838",
            "name": "Node-Operations",
            "color": "#FFFFFF",
            "position": 20
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "",
            "name": "\uD83D\uDC4D",
            "code": "thumbsup",
            "isAnimated": false,
            "imageUrl": "https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg"
          },
          "count": 1,
          "users": [
            {
              "id": "991037531615264808",
              "name": "berzanorg",
              "discriminator": "0000",
              "nickname": "berzan",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
            }
          ]
        }
      ],
      "mentions": [
        {
          "id": "991037531615264808",
          "name": "berzanorg",
          "discriminator": "0000",
          "nickname": "berzan",
          "color": "#FA7504",
          "isBot": false,
          "roles": [
            {
              "id": "1182371055923376168",
              "name": "Mina Navigator",
              "color": "#FA7504",
              "position": 100
            },
            {
              "id": "1220064445863038996",
              "name": "zkApps",
              "color": "#FFFFFF",
              "position": 19
            }
          ],
          "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
        }
      ]
    },
    {
      "id": "1189528511027888168",
      "type": "Default",
      "timestamp": "2023-12-27T15:21:37.4+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "The reason why it didn't work is because there was no account update you can access via `bridgeZkapp.self` to approve, as you didn't deploy the bridge inside the same transaction.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [
        {
          "emoji": {
            "id": "603718596073619477",
            "name": "IconSuccess",
            "code": "IconSuccess",
            "isAnimated": false,
            "imageUrl": "https://cdn.discordapp.com/emojis/603718596073619477.png"
          },
          "count": 2,
          "users": [
            {
              "id": "639674469132140554",
              "name": "godot3791",
              "discriminator": "0000",
              "nickname": "Martin",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/avatars/639674469132140554/dfb6473f38b635487e732dce4c944590.png?size=512"
            },
            {
              "id": "1133657962561421432",
              "name": "david_20244",
              "discriminator": "0000",
              "nickname": "David",
              "isBot": false,
              "avatarUrl": "https://cdn.discordapp.com/embed/avatars/3.png"
            }
          ]
        }
      ],
      "mentions": []
    },
    {
      "id": "1189528564467503154",
      "type": "Default",
      "timestamp": "2023-12-27T15:21:50.141+04:00",
      "timestampEdited": null,
      "callEndedTimestamp": null,
      "isPinned": false,
      "content": "I'm glad it is working now.",
      "author": {
        "id": "991037531615264808",
        "name": "berzanorg",
        "discriminator": "0000",
        "nickname": "berzan",
        "color": "#FA7504",
        "isBot": false,
        "roles": [
          {
            "id": "1182371055923376168",
            "name": "Mina Navigator",
            "color": "#FA7504",
            "position": 100
          },
          {
            "id": "1220064445863038996",
            "name": "zkApps",
            "color": "#FFFFFF",
            "position": 19
          }
        ],
        "avatarUrl": "https://cdn.discordapp.com/avatars/991037531615264808/3ef91bfa9b67c5315e5c06f752a83ed9.png?size=512"
      },
      "attachments": [],
      "embeds": [],
      "stickers": [],
      "reactions": [],
      "mentions": []
    }
  ],
  "messageCount": 36
}